from matplotlib import pyplot as plt
import numpy as np

K = np.array([2, 4, 8, 12, 16, 20])
average_Slopes = np.array([0.6935, 0.5803, 0.4221, 0.3803, 0.3433, 0.3228])
reboot_Slopes = np.array([0.5343, 0.4229, 0.3176, 0.2620, 0.2381, 0.2075])
cmirt_Slopes = np.array([0.5038, 0.3948, 0.2582, 0.2210, 0.2105, 0.1780])
plt.plot(K, reboot_Slopes, marker='o', label="REBOOT estimator")
plt.plot(K, cmirt_Slopes, marker='x', label="Full-sample estimator")
plt.plot(K, average_Slopes, marker='+', label="Average estimator")
plt.legend()
plt.xlabel("Number of Clients (K)")
plt.title("sinTheta distance vs. K")
plt.savefig("Fixed-Local-sinTheta.png")
plt.close()

K = np.array([2, 4, 8, 12, 16, 20])
average_Intercepts = np.array([1.4382, 1.1175, 0.8510, 0.7652, 0.7208, 0.6928])
reboot_Intercepts = np.array([1.1412, 0.9534, 0.5610, 0.5365, 0.4717, 0.3874])
cmirt_Intercepts = np.array([1.0784, 0.8910, 0.5383, 0.4218, 0.3575, 0.3233])
plt.plot(K, reboot_Intercepts, marker='o', label="REBOOT estimator")
plt.plot(K, cmirt_Intercepts, marker='x', label="Full-sample estimator")
plt.plot(K, average_Intercepts, marker='+', label="Average estimator")
plt.legend()
plt.xlabel("Number of Clients (K)")
plt.title("Frobenius norm of difference of estimators vs. K")
plt.savefig("Fixed-Local-frobenius-norm.png")
plt.close()


# FIXED GLOBAL N = 1000: sinTheta Distance
K = np.array([2, 4, 5, 8, 10])
single_Client_Estimator = np.array([0.3715, 0.5177, 0.5542, 0.7896, 0.8752])
average_Estimator = np.array([0.2651, 0.2923, 0.3469, 0.4221, 0.4506])
reboot_Estimator = np.array([0.2762, 0.2875, 0.3127, 0.3176, 0.3155])
cmirt_Estimator = np.array([0.2582, 0.2582, 0.2582, 0.2582, 0.2582])
plt.plot(K, single_Client_Estimator, marker='o',label="Single-Client Estimator")
plt.plot(K, average_Estimator, marker='+',label="Average Estimator")
plt.plot(K, reboot_Estimator, marker='x',label="REBOOT Estimator")
plt.plot(K, cmirt_Estimator, label="Full-sample Estimator")
plt.legend()
plt.xlabel("Number of Clients (K)")
plt.title("sinTheta distance vs. K")
plt.savefig("Fixed-Global-sinTheta-1000.png")
plt.close()

# FIXED GLOBAL N = 1000: Frobenius norm of difference of matrix
K = np.array([2, 4, 5, 8, 10])
single_Client_Estimator = np.array([0.7915, 1.1012,  1.3416, 1.9153, 2.1240])
average_Estimator = np.array([0.5475, 0.5751, 0.6078, 0.8510, 0.9279])
reboot_Estimator = np.array([0.5599, 0.5644, 0.5518, 0.5610, 0.5835])
cmirt_Estimator = np.array([0.5383, 0.5383, 0.5383, 0.5383, 0.5383])
plt.plot(K, single_Client_Estimator, marker='o',label="Single-Client Estimator")
plt.plot(K, average_Estimator, marker='+',label="Average Estimator")
plt.plot(K, reboot_Estimator, marker='x',label="REBOOT Estimator")
plt.plot(K, cmirt_Estimator, label="Full-sample Estimator")
plt.legend()
plt.xlabel("Number of Clients (K)")
plt.title("Frobenius norm of difference of estimators vs. K")
plt.savefig("Fixed-Global-Frobenius-Norm-1000.png")
plt.close()


# FIXED GLOBAL N = 2500: sinTheta Distance
K = np.array([2, 5, 10, 20, 25])
single_Client_Estimator = np.array([0.2307, 0.3630, 0.5228, 0.7943, 0.8942])
average_Estimator = np.array([0.1816, 0.1818, 0.2141, 0.3228, 0.3770])
reboot_Estimator = np.array([0.1851, 0.1832, 0.2028, 0.2075, 0.2214])
cmirt_Estimator = np.array([0.1821, 0.1821, 0.1821, 0.1821, 0.1780])
plt.plot(K, single_Client_Estimator, marker='o',label="Single-Client Estimator")
plt.plot(K, average_Estimator, marker='+',label="Average Estimator")
plt.plot(K, reboot_Estimator, marker='x',label="REBOOT Estimator")
plt.plot(K, cmirt_Estimator, label="Full-sample Estimator")
plt.legend()
plt.xlabel("Number of Clients (K)")
plt.title("sinTheta distance vs. K")
plt.savefig("Fixed-Global-sinTheta-2500.png")
plt.close()

# FIXED GLOBAL N = 2500: Frobenius norm of difference of estimators
K = np.array([2, 5, 10, 20, 25])
single_Client_Estimator = np.array([0.4710, 0.7902,  1.1151, 2.0704, 2.1280])
average_Estimator = np.array([0.3235, 0.3398, 0.4021, 0.6928, 0.7339])
reboot_Estimator = np.array([0.3565, 0.3508, 0.3554, 0.3874, 0.4124])
cmirt_Estimator = np.array([0.3364, 0.3364, 0.3364, 0.3364, 0.3364])
plt.plot(K, single_Client_Estimator, marker='o',label="Single-Client Estimator")
plt.plot(K, average_Estimator, marker='+',label="Average Estimator")
plt.plot(K, reboot_Estimator, marker='x',label="REBOOT Estimator")
plt.plot(K, cmirt_Estimator, label="Full-sample Estimator")
plt.xlabel("Number of Clients (K)")
plt.legend()
plt.title("Frobenius norm of difference of estimators vs. K")
plt.savefig("Fixed-Global-Frobenius-Norm-2500.png")
plt.close()